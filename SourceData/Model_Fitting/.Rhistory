source("X:\\Users\\paudelbb\\Paper_1\\Used R Codes\\summarySE.R")
dd <- "X:/Users/paudelbb/Galactose stress"
setwd(dd)
dir()
dd <- "X:/quaranta/Users/paudelbb/Galactose stress"
setwd(dd)
dd <- "~/quaranta/Users/paudelbb/Galactose stress"
setwd(dd)
getwd()
source("X:\\Users\\paudelbb\\Paper_1\\Used R Codes\\summarySE.R")
source("K:\\Users\\paudelbb\\Paper_1\\Used R Codes\\summarySE.R")
dd <- "~/Volume/quaranta/Users/paudelbb/Galactose stress"
setwd(dd)
dd <- "~/Volumes/quaranta/Users/paudelbb/Galactose stress"
setwd(dd)
dd <- "~/Volumes/Users/paudelbb/Galactose stress"
setwd(dd)
dd <- "~/Volume/Users/paudelbb/Galactose stress"
setwd(dd)
dir()
pwd
dd <- "~/Volumes/quaranta/Users/paudelbb/Galactose stress"
setwd(dd)
285+145
0.06*24
line(0,0)
line(0,10)
segments(0, 0, 2, 2)
plot(nl2~time, data=dn, type="n", ylim=c(-3.5,2.5), xlim=c(0,300), ylab="", xlab="")
segments(0, 0, 2, 2)
#=====================================================================================================
# Supp. Figure 3A: Single-cell-derived SKMEL5 sublines initial response
# concentration used: 8uM PLX4720
# Scatterplot of untreated proliferation rates of sublines with their drug-treated growth rates
#=====================================================================================================
#=====================================================================================================
library(gplots)
require(ggplot2)
setwd("~/Paudel_et_al_2016/SourceData") # Set the working directory;
# Set the output for plots
output <- paste0(substr(getwd(), 1, (nchar(getwd())-nchar("SourceData"))), "Figures")
fig = "Supp.Fig3" # Which figure is this in paper?
output = paste0(output, "/", fig)
#=====================================================================================================
# Read experimental data
#=====================================================================================================
data <- read.csv("SKMEL5 Subclones_initial_screen.csv", header=T, sep=",")
data$Date <- "20150315"
s <- subset(data,  data$Time>=0 & data$Time <100)
dn <- data.frame() # getting the responses from 24-100 hours of treatment
for(i in unique(s$cID)){
tem <- subset(s, s$cID==i)
tem$nl2 = tem$nl2 - tem$nl2[tem$Time==unique(tem$Time)[2]]
tem$Time = tem$Time - tem$Time[tem$Time==unique(tem$Time)[2]]
dn <- rbind(dn, tem)
}
s <- subset(dn, dn$Time>=0)
cl1 <- grey.colors(length(unique(s$cID)))
par(ps = 12, cex = 1, cex.axis = 1)
plot(nl2~Time, data=s, type="n", ylim=c(-1.2,1.2), xlim=c(0,70), ylab="", xlab="")
for(w in 1:length(unique(s$cID))){
temp <- subset(s, s$cID==w)
lines(temp$Time, temp$nl2, col=cl1[w], lwd=2)
}
unique(s$cID)
length(unique(s$cID))
# ===========================================================================================================
# Supp. Figure 6A: MCMC Traceplot for different cell lines
# ===========================================================================================================
library(gplots)
require(ggplot2)
require(FME)
require(deSolve)
library(devtools)
library(ggbiplot)
setwd("~/Paudel_et_al_2016/SourceData/Model_Fitting") # Set the working directory;
# Set the output for plots
output <- paste0(substr(getwd(), 1, (nchar(getwd())-nchar("SourceData/Model_Fitting"))), "Figures")
fig = "Supp.Fig6" # Which figure is this in paper?
output = paste0(output, "/", fig)
# ===========================================================================================================
# Get the MCMC estimated parameters
# ===========================================================================================================
set.seed(12345)
files <- grep(".RData", dir(), value=T)
files
load("MCMC_Subclones_Mix_150000_Run.RData") # SKMEL5
MCMC1$pars <- MCMC1$pars[-(1:dim(MCMC1$pars)[1]/2),]
a <- data.frame(MCMC1$pars)
load("MCMC1_SKMEL5_Parental_150000_Run.RData") # SKMEL5
MCMC1$pars <- MCMC1$pars[-(1:dim(MCMC1$pars)[1]/2),]
b <- data.frame(MCMC1$pars)
head(a)
head(b)
ks.test(a$k_ab, b$k_ab)
hist(a$k_ab)
hist(b$k_ab, add=T)
hist(a$k_ab, freq=F)
hist(a$k_ab, freq=F, ylim=c(0,100))
hist(a$k_ab, freq=F, ylim=c(0,50))
hist(b$k_ab, add=T, col="red", freq=F)
hist(a$k_ba, freq=F, ylim=c(0,50))
hist(b$k_ba, add=T, col="red", freq=F)
hist(a$k_bc, freq=F, ylim=c(0,50))
hist(b$k_bc, add=T, col="red", freq=F)
hist(a$k_cb, freq=F, ylim=c(0,50))
hist(b$k_cb, add=T, col="red", freq=F)
# ===========================================================================================================
# Supp. Figure 6A: MCMC Traceplot for different cell lines
# ===========================================================================================================
library(gplots)
require(ggplot2)
require(FME)
require(deSolve)
library(devtools)
library(ggbiplot)
setwd("~/Paudel_et_al_2016/SourceData/Model_Fitting") # Set the working directory;
# Set the output for plots
output <- paste0(substr(getwd(), 1, (nchar(getwd())-nchar("SourceData/Model_Fitting"))), "Figures")
fig = "Supp.Fig6" # Which figure is this in paper?
output = paste0(output, "/", fig)
# ===========================================================================================================
# Get the MCMC estimated parameters
# ===========================================================================================================
set.seed(12345)
files <- grep(".RData", dir(), value=T)
# ===========================================================================================================
#
# ===========================================================================================================
load("MCMC1_A375_150000_Run.RData") # A375
MCMC1$pars <- MCMC1$pars[-(1:dim(MCMC1$pars)[1]/2),]
pdf(paste0(output, "/", "A375_traceplot.pdf"), width=5.5, height=4)
plot(MCMC1)
dev.off()
load("MCMC_Subclones_Mix_150000_Run.RData") # SKMEL5
MCMC1$pars <- MCMC1$pars[-(1:dim(MCMC1$pars)[1]/2),]
pdf(paste0(output, "/", "SKMEL5_traceplot.pdf"), width=5.5, height=4)
plot(MCMC1)
dev.off()
load("MCMC1_SKMEL19_150000_Run.RData") # SKMEL19
MCMC1$pars <- MCMC1$pars[-(1:dim(MCMC1$pars)[1]/2),]
pdf(paste0(output, "/", "SKMEL19_traceplot.pdf"), width=5.5, height=4)
plot(MCMC1)
dev.off()
load("MCMC1_SKMEL28_150000_Run.RData") # SKMEL28
MCMC1$pars <- MCMC1$pars[-(1:dim(MCMC1$pars)[1]/2),]
pdf(paste0(output, "/", "SKMEL28_traceplot.pdf"), width=5.5, height=4)
plot(MCMC1)
dev.off()
load("MCMC1_WM88_150000_Run.RData") # WM88
MCMC1$pars <- MCMC1$pars[-(1:dim(MCMC1$pars)[1]/2),]
pdf(paste0(output, "/", "WM88_traceplot.pdf"), width=5.5, height=4)
plot(MCMC1)
dev.off()
load("MCMC1_WM164_1e_05_Run.RData") # WM164
MCMC1$pars <- MCMC1$pars[-(1:dim(MCMC1$pars)[1]/2),]
pdf(paste0(output, "/", "WM164_traceplot.pdf"), width=5.5, height=4)
plot(MCMC1)
dev.off()
load("MCMC1_WM793_150000_Run.RData") # WM793
MCMC1$pars <- MCMC1$pars[-(1:dim(MCMC1$pars)[1]/2),]
pdf(paste0(output, "/", "WM793_traceplot.pdf"), width=5.5, height=4)
plot(MCMC1)
dev.off()
